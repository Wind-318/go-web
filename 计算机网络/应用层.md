# 应用层
- ## DNS (域名系统)
  - #### 因为 IP 地址不方便记忆，所以出现了域名。
  - #### DNS 通常是由其他应用层协议所使用的，包括 HTTP、SMTP 和 FTP，将用户提供的主机名解析为 IP 地址。
  - #### 用户主机想获得 IP 地址过程如下：
    - 同一台用户主机上运行着 DNS 应用的客户端
    - 浏览器从 URL 中抽取出主机名，并将主机名传给 DNS 应用的客户端
    - DNS 客户端向 DNS 服务器发送一个包含主机名的请求
    - DNS 客户端收到一份回答报文，其中有对应该主机名的 IP 地址
    - 一旦浏览器收到来自 DNS 的该 IP 地址，它能够向位于该 IP 地址 80 端口的服务器发起一个 TCP 连接
  - #### DNS 服务器分为三种
    - **根 DNS 服务器**
    - **顶级域 DNS 服务器**
    - **权威 DNS 服务器**![](DNS.jpg)
    - 还有一种 DNS 服务器叫本地 DNS 服务器，严格来说它不属于该服务器的层次结构，本地 DNS 服务器通常与主机相隔不超过几台路由器，当主机发出 DNS 请求时，该请求被发往本地 DNS 服务器，它起着代理的作用，并将该请求转发到 DNS 服务器层次结构中。
  - #### DNS 缓存
    - **原理**：在一个请求链中，当某 DNS 服务器接收一个 DNS 回答时，它能将映射缓存在本地存储器中。
  - #### DNS 记录和报文
    - 共同实现 DNS 分布式数据库的所有 DNS 服务器存储了资源记录，资源记录提供了主机名到 IP 地址的映射。
    - 资源记录是一个包含了下列字段的四元组：（Name，Value，Type，TTL）
    - TTL 是该记录的生存时间，它决定了资源记录应当从缓存删除的时间。
    - DNS 查询报文与回答报文格式：![](DNS%20报文.jpg)
- ## Web 和 HTTP
- ## 电子邮件协议
  - 因特网电子邮件系统有三个主要组成部分：**用户代理**、**邮件服务器**和**简单邮件传输协议（SMTP）**。
  - ### SMTP
    - SMTP 用于从发送方的邮件服务器发送报文到接收方的邮件服务器。
  - ### POP3
    - POP3 是一个极为简单的邮件访问协议。
  - ### IMAP
    - IMAP 是一个邮件访问协议。IMAP 服务器把每个报文与一个文件夹联系起来，当报文第一次到达服务器时，它与收件人的 INBOX 文件夹关联。收件人能把邮件移到一个新的、用户创建的文件夹中，阅读邮件，删除邮件等。
- ## FTP (文件传输协议)
  - FTP 使用 TCP 建立两个连接。FTP 使用 21 端口来传送命令，使用 20 端口传输数据。
  - **主动模式**：服务器主动发起连接，服务器端口号为 20，客户端端口号为大于 1024 的随机端口。需要客户端配置防火墙。
  - **被动模式**：客户端主动发起连接，端口号自己指定，服务端端口号随机。只需服务端开启端口号，但会因开放过多端口号导致安全性减弱。